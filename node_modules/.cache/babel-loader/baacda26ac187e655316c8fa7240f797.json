{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useListOption = useListOption;\nexports.useFocusList = exports.FocusListContext = void 0;\n\nvar _querySelectorAll = _interopRequireDefault(require(\"dom-helpers/querySelectorAll\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/* eslint-disable react-hooks/exhaustive-deps */\n\n\nconst FocusListContext = _react.default.createContext(null);\n\nexports.FocusListContext = FocusListContext;\nconst defaultOpts = {\n  behavior: 'stop'\n};\n\nfunction useListOption(dataItem) {\n  const ctx = (0, _react.useContext)(FocusListContext);\n  const prevElement = (0, _react.useRef)(null); // this is a bit convoluted because we want to use a ref object, a callback ref\n  // causes an extra render which is fine except that it means the list hook for\n  // anchor items fires before elements are processed\n\n  const ref = (0, _react.useRef)(null);\n  (0, _react.useLayoutEffect)(() => () => {\n    ctx === null || ctx === void 0 ? void 0 : ctx.map.delete(ref.current);\n  }, []);\n  (0, _react.useLayoutEffect)(() => {\n    if (prevElement.current !== ref.current) {\n      ctx === null || ctx === void 0 ? void 0 : ctx.map.delete(prevElement.current);\n    }\n\n    prevElement.current = ref.current;\n\n    if (ref.current && (ctx === null || ctx === void 0 ? void 0 : ctx.map.get(ref.current)) !== dataItem) {\n      ctx === null || ctx === void 0 ? void 0 : ctx.map.set(ref.current, dataItem);\n    }\n  });\n  const focused = dataItem === (ctx === null || ctx === void 0 ? void 0 : ctx.focusedItem);\n  return [ref, focused, focused ? ctx === null || ctx === void 0 ? void 0 : ctx.activeId : undefined];\n}\n\nconst useFocusList = ({\n  scope: listRef,\n  anchorItem,\n  focusFirstItem: _focusFirstItem = false,\n  scopeSelector: _scopeSelector = '',\n  activeId\n}) => {\n  const map = (0, _react.useMemo)(() => new WeakMap(), []);\n  const [focusedItem, setFocusedItem] = (0, _react.useState)();\n  const itemSelector = `${_scopeSelector} [data-rw-focusable]`.trim();\n\n  const get = () => {\n    const items = (0, _querySelectorAll.default)(listRef.current, itemSelector);\n    return [items, items.find(e => e.dataset.rwFocused === '')];\n  };\n\n  const list = (0, _react.useMemo)(() => {\n    return {\n      get,\n      toDataItem: el => map.get(el),\n\n      first() {\n        const [[first]] = get();\n        return first;\n      },\n\n      focus(el) {\n        if (!el || map.has(el)) setFocusedItem(el ? map.get(el) : undefined);\n      },\n\n      last() {\n        const [items] = get();\n        return items[items.length - 1];\n      },\n\n      next({\n        behavior\n      } = defaultOpts) {\n        const [items, focusedItem] = get();\n        let nextIdx = items.indexOf(focusedItem) + 1;\n\n        if (nextIdx >= items.length) {\n          if (behavior === 'loop') return items[0];\n          if (behavior === 'clear') return undefined;\n          return focusedItem;\n        }\n\n        return items[nextIdx];\n      },\n\n      prev({\n        behavior\n      } = defaultOpts) {\n        const [items, focusedItem] = get();\n        let nextIdx = Math.max(0, items.indexOf(focusedItem)) - 1;\n\n        if (nextIdx < 0) {\n          if (behavior === 'loop') return items[items.length - 1];\n          if (behavior === 'clear') return undefined;\n          return focusedItem;\n        }\n\n        return items[nextIdx];\n      }\n\n    };\n  }, []);\n  (0, _react.useLayoutEffect)(() => {\n    if (!anchorItem) {\n      list.focus(null);\n      return;\n    }\n\n    const element = get()[0].find(el => list.toDataItem(el) === anchorItem);\n    list.focus(element);\n  }, [anchorItem]);\n  (0, _react.useLayoutEffect)(() => {\n    if (!listRef.current) return;\n    const [, focusedElement] = get();\n    const hasItem = focusedElement != null;\n\n    if (!hasItem && _focusFirstItem || hasItem && !listRef.current.contains(focusedElement)) {\n      if (_focusFirstItem) list.focus(list.first());else list.focus(null);\n    }\n  });\n  const context = (0, _react.useMemo)(() => ({\n    map,\n    focusedItem,\n    activeId\n  }), [focusedItem, activeId]);\n  list.context = context;\n  list.getFocused = (0, _react.useCallback)(() => focusedItem, [focusedItem]);\n\n  list.hasFocused = () => focusedItem !== undefined;\n\n  return list;\n};\n\nexports.useFocusList = useFocusList;","map":{"version":3,"sources":["D:/workspace2021/projectmanagement/client/node_modules/react-widgets/lib/FocusListContext.js"],"names":["Object","defineProperty","exports","value","useListOption","useFocusList","FocusListContext","_querySelectorAll","_interopRequireDefault","require","_react","_interopRequireWildcard","_getRequireWildcardCache","WeakMap","cache","obj","__esModule","default","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","createContext","defaultOpts","behavior","dataItem","ctx","useContext","prevElement","useRef","ref","useLayoutEffect","map","delete","current","focused","focusedItem","activeId","undefined","scope","listRef","anchorItem","focusFirstItem","_focusFirstItem","scopeSelector","_scopeSelector","useMemo","setFocusedItem","useState","itemSelector","trim","items","find","e","dataset","rwFocused","list","toDataItem","el","first","focus","last","length","next","nextIdx","indexOf","prev","Math","max","element","focusedElement","hasItem","contains","context","getFocused","useCallback","hasFocused"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useListOption = useListOption;\nexports.useFocusList = exports.FocusListContext = void 0;\n\nvar _querySelectorAll = _interopRequireDefault(require(\"dom-helpers/querySelectorAll\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* eslint-disable react-hooks/exhaustive-deps */\nconst FocusListContext = _react.default.createContext(null);\n\nexports.FocusListContext = FocusListContext;\nconst defaultOpts = {\n  behavior: 'stop'\n};\n\nfunction useListOption(dataItem) {\n  const ctx = (0, _react.useContext)(FocusListContext);\n  const prevElement = (0, _react.useRef)(null); // this is a bit convoluted because we want to use a ref object, a callback ref\n  // causes an extra render which is fine except that it means the list hook for\n  // anchor items fires before elements are processed\n\n  const ref = (0, _react.useRef)(null);\n  (0, _react.useLayoutEffect)(() => () => {\n    ctx === null || ctx === void 0 ? void 0 : ctx.map.delete(ref.current);\n  }, []);\n  (0, _react.useLayoutEffect)(() => {\n    if (prevElement.current !== ref.current) {\n      ctx === null || ctx === void 0 ? void 0 : ctx.map.delete(prevElement.current);\n    }\n\n    prevElement.current = ref.current;\n\n    if (ref.current && (ctx === null || ctx === void 0 ? void 0 : ctx.map.get(ref.current)) !== dataItem) {\n      ctx === null || ctx === void 0 ? void 0 : ctx.map.set(ref.current, dataItem);\n    }\n  });\n  const focused = dataItem === (ctx === null || ctx === void 0 ? void 0 : ctx.focusedItem);\n  return [ref, focused, focused ? ctx === null || ctx === void 0 ? void 0 : ctx.activeId : undefined];\n}\n\nconst useFocusList = ({\n  scope: listRef,\n  anchorItem,\n  focusFirstItem: _focusFirstItem = false,\n  scopeSelector: _scopeSelector = '',\n  activeId\n}) => {\n  const map = (0, _react.useMemo)(() => new WeakMap(), []);\n  const [focusedItem, setFocusedItem] = (0, _react.useState)();\n  const itemSelector = `${_scopeSelector} [data-rw-focusable]`.trim();\n\n  const get = () => {\n    const items = (0, _querySelectorAll.default)(listRef.current, itemSelector);\n    return [items, items.find(e => e.dataset.rwFocused === '')];\n  };\n\n  const list = (0, _react.useMemo)(() => {\n    return {\n      get,\n      toDataItem: el => map.get(el),\n\n      first() {\n        const [[first]] = get();\n        return first;\n      },\n\n      focus(el) {\n        if (!el || map.has(el)) setFocusedItem(el ? map.get(el) : undefined);\n      },\n\n      last() {\n        const [items] = get();\n        return items[items.length - 1];\n      },\n\n      next({\n        behavior\n      } = defaultOpts) {\n        const [items, focusedItem] = get();\n        let nextIdx = items.indexOf(focusedItem) + 1;\n\n        if (nextIdx >= items.length) {\n          if (behavior === 'loop') return items[0];\n          if (behavior === 'clear') return undefined;\n          return focusedItem;\n        }\n\n        return items[nextIdx];\n      },\n\n      prev({\n        behavior\n      } = defaultOpts) {\n        const [items, focusedItem] = get();\n        let nextIdx = Math.max(0, items.indexOf(focusedItem)) - 1;\n\n        if (nextIdx < 0) {\n          if (behavior === 'loop') return items[items.length - 1];\n          if (behavior === 'clear') return undefined;\n          return focusedItem;\n        }\n\n        return items[nextIdx];\n      }\n\n    };\n  }, []);\n  (0, _react.useLayoutEffect)(() => {\n    if (!anchorItem) {\n      list.focus(null);\n      return;\n    }\n\n    const element = get()[0].find(el => list.toDataItem(el) === anchorItem);\n    list.focus(element);\n  }, [anchorItem]);\n  (0, _react.useLayoutEffect)(() => {\n    if (!listRef.current) return;\n    const [, focusedElement] = get();\n    const hasItem = focusedElement != null;\n\n    if (!hasItem && _focusFirstItem || hasItem && !listRef.current.contains(focusedElement)) {\n      if (_focusFirstItem) list.focus(list.first());else list.focus(null);\n    }\n  });\n  const context = (0, _react.useMemo)(() => ({\n    map,\n    focusedItem,\n    activeId\n  }), [focusedItem, activeId]);\n  list.context = context;\n  list.getFocused = (0, _react.useCallback)(() => focusedItem, [focusedItem]);\n\n  list.hasFocused = () => focusedItem !== undefined;\n\n  return list;\n};\n\nexports.useFocusList = useFocusList;"]},"metadata":{},"sourceType":"script"}