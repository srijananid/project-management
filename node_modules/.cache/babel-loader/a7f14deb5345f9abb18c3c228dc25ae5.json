{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _uncontrollable = require(\"uncontrollable\");\n\nvar _Icon = require(\"./Icon\");\n\nvar _Input = _interopRequireDefault(require(\"./Input\"));\n\nvar _List = _interopRequireDefault(require(\"./List\"));\n\nvar _FocusListContext = require(\"./FocusListContext\");\n\nvar _Popup = _interopRequireDefault(require(\"./Popup\"));\n\nvar _InputAddon = _interopRequireDefault(require(\"./InputAddon\"));\n\nvar _Widget = _interopRequireDefault(require(\"./Widget\"));\n\nvar _WidgetPicker = _interopRequireDefault(require(\"./WidgetPicker\"));\n\nvar _messages = require(\"./messages\");\n\nvar _A11y = require(\"./A11y\");\n\nvar CustomPropTypes = _interopRequireWildcard(require(\"./PropTypes\"));\n\nvar _Accessors = require(\"./Accessors\");\n\nvar _Filter = require(\"./Filter\");\n\nvar _useDropdownToggle = _interopRequireDefault(require(\"./useDropdownToggle\"));\n\nvar _useFocusManager = _interopRequireDefault(require(\"./useFocusManager\"));\n\nvar _WidgetHelpers = require(\"./WidgetHelpers\");\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function () {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nfunction indexOf(data, searchTerm, text) {\n  if (!searchTerm.trim()) return -1;\n\n  for (let idx = 0; idx < data.length; idx++) if (text(data[idx]).toLowerCase() === searchTerm) return idx;\n\n  return -1;\n}\n\nlet propTypes = {\n  value: PropTypes.any,\n  onChange: PropTypes.func,\n  open: PropTypes.bool,\n  onToggle: PropTypes.func,\n  renderListItem: PropTypes.func,\n  listComponent: PropTypes.elementType,\n  renderListGroup: PropTypes.func,\n  groupBy: CustomPropTypes.accessor,\n  data: PropTypes.array,\n  dataKey: CustomPropTypes.accessor,\n  textField: CustomPropTypes.accessor,\n  name: PropTypes.string,\n  hideEmptyPopup: PropTypes.bool,\n  hideCaret: PropTypes.bool,\n\n  /**\n   *\n   * @type {(dataItem: ?any, metadata: { originalEvent: SyntheticEvent }) => void}\n   */\n  onSelect: PropTypes.func,\n  autoFocus: PropTypes.bool,\n  disabled: CustomPropTypes.disabled.acceptsArray,\n  readOnly: CustomPropTypes.disabled,\n  busy: PropTypes.bool,\n\n  /** Specify the element used to render the select (down arrow) icon. */\n  selectIcon: PropTypes.node,\n\n  /** Specify the element used to render the busy indicator */\n  busySpinner: PropTypes.node,\n  dropUp: PropTypes.bool,\n  popupTransition: PropTypes.elementType,\n  placeholder: PropTypes.string,\n\n  /** Adds a css class to the input container element. */\n  containerClassName: PropTypes.string,\n  inputProps: PropTypes.object,\n  listProps: PropTypes.object,\n  messages: PropTypes.shape({\n    openCombobox: CustomPropTypes.message,\n    emptyList: CustomPropTypes.message,\n    emptyFilter: CustomPropTypes.message\n  })\n};\n/**\n * ---\n * shortcuts:\n *   - { key: alt + down arrow, label: open combobox }\n *   - { key: alt + up arrow, label: close combobox }\n *   - { key: down arrow, label: move focus to next item }\n *   - { key: up arrow, label: move focus to previous item }\n *   - { key: home, label: move focus to first item }\n *   - { key: end, label: move focus to last item }\n *   - { key: enter, label: select focused item }\n *   - { key: any key, label: search list for item starting with key }\n * ---\n *\n * Select an item from the list, or input a custom value. The Combobox can also make suggestions as you type.\n\n * @public\n */\n\nconst ComboboxImpl = React.forwardRef(function Combobox(_ref, outerRef) {\n  let {\n    id,\n    className,\n    containerClassName,\n    placeholder,\n    autoFocus,\n    textField,\n    dataKey,\n    autoSelectMatches,\n    focusFirstItem = false,\n    value,\n    defaultValue = '',\n    onChange,\n    open,\n    defaultOpen = false,\n    onToggle,\n    filter = true,\n    busy,\n    disabled,\n    readOnly,\n    selectIcon = _Icon.caretDown,\n    hideCaret,\n    hideEmptyPopup,\n    busySpinner,\n    dropUp,\n    tabIndex,\n    popupTransition,\n    name,\n    onSelect,\n    onKeyDown,\n    onBlur,\n    onFocus,\n    inputProps,\n    listProps,\n    groupBy,\n    renderListItem,\n    renderListGroup,\n    optionComponent,\n    listComponent: ListComponent = _List.default,\n    data: rawData = [],\n    messages: userMessages\n  } = _ref,\n      elementProps = _objectWithoutProperties(_ref, [\"id\", \"className\", \"containerClassName\", \"placeholder\", \"autoFocus\", \"textField\", \"dataKey\", \"autoSelectMatches\", \"focusFirstItem\", \"value\", \"defaultValue\", \"onChange\", \"open\", \"defaultOpen\", \"onToggle\", \"filter\", \"busy\", \"disabled\", \"readOnly\", \"selectIcon\", \"hideCaret\", \"hideEmptyPopup\", \"busySpinner\", \"dropUp\", \"tabIndex\", \"popupTransition\", \"name\", \"onSelect\", \"onKeyDown\", \"onBlur\", \"onFocus\", \"inputProps\", \"listProps\", \"groupBy\", \"renderListItem\", \"renderListGroup\", \"optionComponent\", \"listComponent\", \"data\", \"messages\"]);\n\n  let [currentValue, handleChange] = (0, _uncontrollable.useUncontrolledProp)(value, defaultValue, onChange);\n  const [currentOpen, handleOpen] = (0, _uncontrollable.useUncontrolledProp)(open, defaultOpen, onToggle);\n  const ref = (0, React.useRef)(null);\n  const inputRef = (0, React.useRef)(null);\n  const listRef = (0, React.useRef)(null);\n  const [suggestion, setSuggestion] = (0, React.useState)(null);\n  const shouldFilter = (0, React.useRef)(false);\n  const inputId = (0, _WidgetHelpers.useInstanceId)(id, '_input');\n  const listId = (0, _WidgetHelpers.useInstanceId)(id, '_listbox');\n  const activeId = (0, _WidgetHelpers.useInstanceId)(id, '_listbox_active_option');\n  const accessors = (0, _Accessors.useAccessors)(textField, dataKey);\n  const messages = (0, _messages.useMessagesWithDefaults)(userMessages);\n  const toggle = (0, _useDropdownToggle.default)(currentOpen, handleOpen);\n  const isDisabled = disabled === true;\n  const isReadOnly = !!readOnly;\n  const data = (0, _Filter.useFilteredData)(rawData, filter, shouldFilter.current ? accessors.text(currentValue) : void 0, accessors.text);\n  const selectedItem = (0, React.useMemo)(() => data[accessors.indexOf(data, currentValue)], [data, currentValue, accessors]);\n  const list = (0, _FocusListContext.useFocusList)({\n    activeId,\n    scope: ref,\n    focusFirstItem,\n    anchorItem: currentOpen ? selectedItem : undefined\n  });\n  const [focusEvents, focused] = (0, _useFocusManager.default)(ref, {\n    disabled: isDisabled,\n    onBlur,\n    onFocus\n  }, {\n    didHandle(focused) {\n      if (!focused) {\n        shouldFilter.current = false;\n        toggle.close();\n        setSuggestion(null);\n        list.focus(undefined);\n      } else {\n        focus({\n          preventScroll: true\n        });\n      }\n    }\n\n  });\n  (0, _A11y.useActiveDescendant)(ref, activeId, currentOpen, [list.getFocused()]);\n  /**\n   * Handlers\n   */\n\n  const handleClick = () => {\n    if (readOnly || disabled) return;\n    focus();\n    toggle();\n  };\n\n  const handleSelect = (data, originalEvent) => {\n    toggle.close();\n    shouldFilter.current = false;\n    setSuggestion(null);\n    (0, _WidgetHelpers.notify)(onSelect, [data, {\n      originalEvent\n    }]);\n    change(data, originalEvent);\n    focus({\n      preventScroll: true\n    });\n  };\n\n  const handleInputKeyDown = ({\n    key\n  }) => {\n    if (key === 'Backspace' || key === 'Delete') {\n      list.focus(null);\n    }\n  };\n\n  const handleInputChange = event => {\n    let idx = autoSelectMatches ? indexOf(rawData, event.target.value.toLowerCase(), accessors.text) : -1;\n    shouldFilter.current = true;\n    setSuggestion(null);\n    change(idx === -1 ? event.target.value : rawData[idx], event);\n    toggle.open();\n  };\n\n  const handleKeyDown = e => {\n    if (readOnly) return;\n    let {\n      key,\n      altKey,\n      shiftKey\n    } = e;\n    (0, _WidgetHelpers.notify)(onKeyDown, [e]);\n    if (e.defaultPrevented) return;\n\n    const select = item => item != null && handleSelect(item, e);\n\n    const setFocused = el => {\n      if (!el) return;\n      setSuggestion(list.toDataItem(el));\n      list.focus(el);\n    };\n\n    if (key === 'End' && currentOpen && !shiftKey) {\n      e.preventDefault();\n      setFocused(list.last());\n    } else if (key === 'Home' && currentOpen && !shiftKey) {\n      e.preventDefault();\n      setFocused(list.first());\n    } else if (key === 'Escape' && currentOpen) {\n      e.preventDefault();\n      setSuggestion(null);\n      toggle.close();\n    } else if (key === 'Enter' && currentOpen) {\n      e.preventDefault();\n      select(list.getFocused());\n    } else if (key === 'ArrowDown') {\n      e.preventDefault();\n\n      if (currentOpen) {\n        setFocused(list.next());\n      } else {\n        return toggle.open();\n      }\n    } else if (key === 'ArrowUp') {\n      e.preventDefault();\n      if (altKey) return toggle.close();\n\n      if (currentOpen) {\n        setFocused(list.prev());\n      }\n    }\n  };\n  /**\n   * Methods\n   */\n\n\n  function focus(opts) {\n    if (inputRef.current) inputRef.current.focus(opts);\n  }\n\n  function change(nextValue, originalEvent) {\n    handleChange(nextValue, {\n      lastValue: currentValue,\n      originalEvent\n    });\n  }\n  /**\n   * Rendering\n   */\n\n\n  (0, React.useImperativeHandle)(outerRef, () => ({\n    focus\n  }));\n  let shouldRenderPopup = (0, _WidgetHelpers.useFirstFocusedRender)(focused, currentOpen);\n  let valueItem = accessors.findOrSelf(data, currentValue);\n  let inputValue = accessors.text(suggestion || valueItem);\n  let completeType = filter ? 'list' : 'none';\n  let popupOpen = currentOpen && (!hideEmptyPopup || !!data.length);\n  return /*#__PURE__*/React.createElement(_Widget.default, Object.assign({}, elementProps, {\n    ref: ref,\n    open: currentOpen,\n    dropUp: dropUp,\n    focused: focused,\n    disabled: isDisabled,\n    readOnly: isReadOnly\n  }, focusEvents, {\n    onKeyDown: handleKeyDown,\n    className: (0, _classnames.default)(className, 'rw-combobox')\n  }), /*#__PURE__*/React.createElement(_WidgetPicker.default, {\n    className: containerClassName,\n    hideCaret: hideCaret\n  }, /*#__PURE__*/React.createElement(_Input.default, Object.assign({}, inputProps, {\n    role: \"combobox\",\n    name: name,\n    id: inputId,\n    className: (0, _classnames.default)( // @ts-ignore\n    inputProps && inputProps.className, 'rw-widget-input rw-combobox-input'),\n    autoFocus: autoFocus,\n    tabIndex: tabIndex,\n    disabled: isDisabled,\n    readOnly: isReadOnly,\n    \"aria-busy\": !!busy,\n    \"aria-owns\": listId,\n    \"aria-autocomplete\": completeType,\n    \"aria-expanded\": currentOpen,\n    \"aria-haspopup\": true,\n    placeholder: placeholder,\n    value: inputValue,\n    onChange: handleInputChange,\n    onKeyDown: handleInputKeyDown,\n    ref: inputRef\n  })), !hideCaret && /*#__PURE__*/React.createElement(_InputAddon.default, {\n    busy: busy,\n    icon: selectIcon,\n    spinner: busySpinner,\n    onClick: handleClick,\n    disabled: !!isDisabled || isReadOnly // FIXME\n    ,\n    label: messages.openCombobox()\n  })), /*#__PURE__*/React.createElement(_FocusListContext.FocusListContext.Provider, {\n    value: list.context\n  }, shouldRenderPopup && /*#__PURE__*/React.createElement(_Popup.default, {\n    dropUp: dropUp,\n    open: popupOpen,\n    transition: popupTransition,\n    onEntering: () => listRef.current.scrollIntoView()\n  }, /*#__PURE__*/React.createElement(ListComponent, Object.assign({}, listProps, {\n    id: listId,\n    tabIndex: -1,\n    data: data,\n    groupBy: groupBy,\n    disabled: disabled,\n    accessors: accessors,\n    renderItem: renderListItem,\n    renderGroup: renderListGroup,\n    optionComponent: optionComponent,\n    value: selectedItem,\n    searchTerm: valueItem && accessors.text(valueItem) || '',\n    \"aria-hidden\": !popupOpen,\n    \"aria-labelledby\": inputId,\n    \"aria-live\": popupOpen ? 'polite' : void 0,\n    onChange: (d, meta) => handleSelect(d, meta.originalEvent),\n    ref: listRef,\n    messages: {\n      emptyList: rawData.length ? messages.emptyFilter : messages.emptyList\n    }\n  })))));\n});\nComboboxImpl.displayName = 'Combobox';\nComboboxImpl.propTypes = propTypes;\nvar _default = ComboboxImpl;\nexports.default = _default;","map":{"version":3,"sources":["D:/workspace2021/projectmanagement/client/node_modules/react-widgets/lib/Combobox.js"],"names":["Object","defineProperty","exports","value","default","_classnames","_interopRequireDefault","require","PropTypes","_interopRequireWildcard","React","_uncontrollable","_Icon","_Input","_List","_FocusListContext","_Popup","_InputAddon","_Widget","_WidgetPicker","_messages","_A11y","CustomPropTypes","_Accessors","_Filter","_useDropdownToggle","_useFocusManager","_WidgetHelpers","_getRequireWildcardCache","WeakMap","cache","obj","__esModule","has","get","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","_objectWithoutProperties","source","excluded","target","_objectWithoutPropertiesLoose","i","getOwnPropertySymbols","sourceSymbolKeys","length","indexOf","propertyIsEnumerable","sourceKeys","keys","data","searchTerm","text","trim","idx","toLowerCase","propTypes","any","onChange","func","open","bool","onToggle","renderListItem","listComponent","elementType","renderListGroup","groupBy","accessor","array","dataKey","textField","name","string","hideEmptyPopup","hideCaret","onSelect","autoFocus","disabled","acceptsArray","readOnly","busy","selectIcon","node","busySpinner","dropUp","popupTransition","placeholder","containerClassName","inputProps","object","listProps","messages","shape","openCombobox","message","emptyList","emptyFilter","ComboboxImpl","forwardRef","Combobox","_ref","outerRef","id","className","autoSelectMatches","focusFirstItem","defaultValue","defaultOpen","filter","caretDown","tabIndex","onKeyDown","onBlur","onFocus","optionComponent","ListComponent","rawData","userMessages","elementProps","currentValue","handleChange","useUncontrolledProp","currentOpen","handleOpen","ref","useRef","inputRef","listRef","suggestion","setSuggestion","useState","shouldFilter","inputId","useInstanceId","listId","activeId","accessors","useAccessors","useMessagesWithDefaults","toggle","isDisabled","isReadOnly","useFilteredData","current","selectedItem","useMemo","list","useFocusList","scope","anchorItem","undefined","focusEvents","focused","didHandle","close","focus","preventScroll","useActiveDescendant","getFocused","handleClick","handleSelect","originalEvent","notify","change","handleInputKeyDown","handleInputChange","event","handleKeyDown","e","altKey","shiftKey","defaultPrevented","select","item","setFocused","el","toDataItem","preventDefault","last","first","next","prev","opts","nextValue","lastValue","useImperativeHandle","shouldRenderPopup","useFirstFocusedRender","valueItem","findOrSelf","inputValue","completeType","popupOpen","createElement","assign","role","icon","spinner","onClick","label","FocusListContext","Provider","context","transition","onEntering","scrollIntoView","renderItem","renderGroup","d","meta","displayName","_default"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classnames = _interopRequireDefault(require(\"classnames\"));\n\nvar PropTypes = _interopRequireWildcard(require(\"prop-types\"));\n\nvar React = _interopRequireWildcard(require(\"react\"));\n\nvar _uncontrollable = require(\"uncontrollable\");\n\nvar _Icon = require(\"./Icon\");\n\nvar _Input = _interopRequireDefault(require(\"./Input\"));\n\nvar _List = _interopRequireDefault(require(\"./List\"));\n\nvar _FocusListContext = require(\"./FocusListContext\");\n\nvar _Popup = _interopRequireDefault(require(\"./Popup\"));\n\nvar _InputAddon = _interopRequireDefault(require(\"./InputAddon\"));\n\nvar _Widget = _interopRequireDefault(require(\"./Widget\"));\n\nvar _WidgetPicker = _interopRequireDefault(require(\"./WidgetPicker\"));\n\nvar _messages = require(\"./messages\");\n\nvar _A11y = require(\"./A11y\");\n\nvar CustomPropTypes = _interopRequireWildcard(require(\"./PropTypes\"));\n\nvar _Accessors = require(\"./Accessors\");\n\nvar _Filter = require(\"./Filter\");\n\nvar _useDropdownToggle = _interopRequireDefault(require(\"./useDropdownToggle\"));\n\nvar _useFocusManager = _interopRequireDefault(require(\"./useFocusManager\"));\n\nvar _WidgetHelpers = require(\"./WidgetHelpers\");\n\nfunction _getRequireWildcardCache() { if (typeof WeakMap !== \"function\") return null; var cache = new WeakMap(); _getRequireWildcardCache = function () { return cache; }; return cache; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") { return { default: obj }; } var cache = _getRequireWildcardCache(); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nfunction indexOf(data, searchTerm, text) {\n  if (!searchTerm.trim()) return -1;\n\n  for (let idx = 0; idx < data.length; idx++) if (text(data[idx]).toLowerCase() === searchTerm) return idx;\n\n  return -1;\n}\n\nlet propTypes = {\n  value: PropTypes.any,\n  onChange: PropTypes.func,\n  open: PropTypes.bool,\n  onToggle: PropTypes.func,\n  renderListItem: PropTypes.func,\n  listComponent: PropTypes.elementType,\n  renderListGroup: PropTypes.func,\n  groupBy: CustomPropTypes.accessor,\n  data: PropTypes.array,\n  dataKey: CustomPropTypes.accessor,\n  textField: CustomPropTypes.accessor,\n  name: PropTypes.string,\n  hideEmptyPopup: PropTypes.bool,\n  hideCaret: PropTypes.bool,\n\n  /**\n   *\n   * @type {(dataItem: ?any, metadata: { originalEvent: SyntheticEvent }) => void}\n   */\n  onSelect: PropTypes.func,\n  autoFocus: PropTypes.bool,\n  disabled: CustomPropTypes.disabled.acceptsArray,\n  readOnly: CustomPropTypes.disabled,\n  busy: PropTypes.bool,\n\n  /** Specify the element used to render the select (down arrow) icon. */\n  selectIcon: PropTypes.node,\n\n  /** Specify the element used to render the busy indicator */\n  busySpinner: PropTypes.node,\n  dropUp: PropTypes.bool,\n  popupTransition: PropTypes.elementType,\n  placeholder: PropTypes.string,\n\n  /** Adds a css class to the input container element. */\n  containerClassName: PropTypes.string,\n  inputProps: PropTypes.object,\n  listProps: PropTypes.object,\n  messages: PropTypes.shape({\n    openCombobox: CustomPropTypes.message,\n    emptyList: CustomPropTypes.message,\n    emptyFilter: CustomPropTypes.message\n  })\n};\n\n/**\n * ---\n * shortcuts:\n *   - { key: alt + down arrow, label: open combobox }\n *   - { key: alt + up arrow, label: close combobox }\n *   - { key: down arrow, label: move focus to next item }\n *   - { key: up arrow, label: move focus to previous item }\n *   - { key: home, label: move focus to first item }\n *   - { key: end, label: move focus to last item }\n *   - { key: enter, label: select focused item }\n *   - { key: any key, label: search list for item starting with key }\n * ---\n *\n * Select an item from the list, or input a custom value. The Combobox can also make suggestions as you type.\n\n * @public\n */\nconst ComboboxImpl = React.forwardRef(function Combobox(_ref, outerRef) {\n  let {\n    id,\n    className,\n    containerClassName,\n    placeholder,\n    autoFocus,\n    textField,\n    dataKey,\n    autoSelectMatches,\n    focusFirstItem = false,\n    value,\n    defaultValue = '',\n    onChange,\n    open,\n    defaultOpen = false,\n    onToggle,\n    filter = true,\n    busy,\n    disabled,\n    readOnly,\n    selectIcon = _Icon.caretDown,\n    hideCaret,\n    hideEmptyPopup,\n    busySpinner,\n    dropUp,\n    tabIndex,\n    popupTransition,\n    name,\n    onSelect,\n    onKeyDown,\n    onBlur,\n    onFocus,\n    inputProps,\n    listProps,\n    groupBy,\n    renderListItem,\n    renderListGroup,\n    optionComponent,\n    listComponent: ListComponent = _List.default,\n    data: rawData = [],\n    messages: userMessages\n  } = _ref,\n      elementProps = _objectWithoutProperties(_ref, [\"id\", \"className\", \"containerClassName\", \"placeholder\", \"autoFocus\", \"textField\", \"dataKey\", \"autoSelectMatches\", \"focusFirstItem\", \"value\", \"defaultValue\", \"onChange\", \"open\", \"defaultOpen\", \"onToggle\", \"filter\", \"busy\", \"disabled\", \"readOnly\", \"selectIcon\", \"hideCaret\", \"hideEmptyPopup\", \"busySpinner\", \"dropUp\", \"tabIndex\", \"popupTransition\", \"name\", \"onSelect\", \"onKeyDown\", \"onBlur\", \"onFocus\", \"inputProps\", \"listProps\", \"groupBy\", \"renderListItem\", \"renderListGroup\", \"optionComponent\", \"listComponent\", \"data\", \"messages\"]);\n\n  let [currentValue, handleChange] = (0, _uncontrollable.useUncontrolledProp)(value, defaultValue, onChange);\n  const [currentOpen, handleOpen] = (0, _uncontrollable.useUncontrolledProp)(open, defaultOpen, onToggle);\n  const ref = (0, React.useRef)(null);\n  const inputRef = (0, React.useRef)(null);\n  const listRef = (0, React.useRef)(null);\n  const [suggestion, setSuggestion] = (0, React.useState)(null);\n  const shouldFilter = (0, React.useRef)(false);\n  const inputId = (0, _WidgetHelpers.useInstanceId)(id, '_input');\n  const listId = (0, _WidgetHelpers.useInstanceId)(id, '_listbox');\n  const activeId = (0, _WidgetHelpers.useInstanceId)(id, '_listbox_active_option');\n  const accessors = (0, _Accessors.useAccessors)(textField, dataKey);\n  const messages = (0, _messages.useMessagesWithDefaults)(userMessages);\n  const toggle = (0, _useDropdownToggle.default)(currentOpen, handleOpen);\n  const isDisabled = disabled === true;\n  const isReadOnly = !!readOnly;\n  const data = (0, _Filter.useFilteredData)(rawData, filter, shouldFilter.current ? accessors.text(currentValue) : void 0, accessors.text);\n  const selectedItem = (0, React.useMemo)(() => data[accessors.indexOf(data, currentValue)], [data, currentValue, accessors]);\n  const list = (0, _FocusListContext.useFocusList)({\n    activeId,\n    scope: ref,\n    focusFirstItem,\n    anchorItem: currentOpen ? selectedItem : undefined\n  });\n  const [focusEvents, focused] = (0, _useFocusManager.default)(ref, {\n    disabled: isDisabled,\n    onBlur,\n    onFocus\n  }, {\n    didHandle(focused) {\n      if (!focused) {\n        shouldFilter.current = false;\n        toggle.close();\n        setSuggestion(null);\n        list.focus(undefined);\n      } else {\n        focus({\n          preventScroll: true\n        });\n      }\n    }\n\n  });\n  (0, _A11y.useActiveDescendant)(ref, activeId, currentOpen, [list.getFocused()]);\n  /**\n   * Handlers\n   */\n\n  const handleClick = () => {\n    if (readOnly || disabled) return;\n    focus();\n    toggle();\n  };\n\n  const handleSelect = (data, originalEvent) => {\n    toggle.close();\n    shouldFilter.current = false;\n    setSuggestion(null);\n    (0, _WidgetHelpers.notify)(onSelect, [data, {\n      originalEvent\n    }]);\n    change(data, originalEvent);\n    focus({\n      preventScroll: true\n    });\n  };\n\n  const handleInputKeyDown = ({\n    key\n  }) => {\n    if (key === 'Backspace' || key === 'Delete') {\n      list.focus(null);\n    }\n  };\n\n  const handleInputChange = event => {\n    let idx = autoSelectMatches ? indexOf(rawData, event.target.value.toLowerCase(), accessors.text) : -1;\n    shouldFilter.current = true;\n    setSuggestion(null);\n    change(idx === -1 ? event.target.value : rawData[idx], event);\n    toggle.open();\n  };\n\n  const handleKeyDown = e => {\n    if (readOnly) return;\n    let {\n      key,\n      altKey,\n      shiftKey\n    } = e;\n    (0, _WidgetHelpers.notify)(onKeyDown, [e]);\n    if (e.defaultPrevented) return;\n\n    const select = item => item != null && handleSelect(item, e);\n\n    const setFocused = el => {\n      if (!el) return;\n      setSuggestion(list.toDataItem(el));\n      list.focus(el);\n    };\n\n    if (key === 'End' && currentOpen && !shiftKey) {\n      e.preventDefault();\n      setFocused(list.last());\n    } else if (key === 'Home' && currentOpen && !shiftKey) {\n      e.preventDefault();\n      setFocused(list.first());\n    } else if (key === 'Escape' && currentOpen) {\n      e.preventDefault();\n      setSuggestion(null);\n      toggle.close();\n    } else if (key === 'Enter' && currentOpen) {\n      e.preventDefault();\n      select(list.getFocused());\n    } else if (key === 'ArrowDown') {\n      e.preventDefault();\n\n      if (currentOpen) {\n        setFocused(list.next());\n      } else {\n        return toggle.open();\n      }\n    } else if (key === 'ArrowUp') {\n      e.preventDefault();\n      if (altKey) return toggle.close();\n\n      if (currentOpen) {\n        setFocused(list.prev());\n      }\n    }\n  };\n  /**\n   * Methods\n   */\n\n\n  function focus(opts) {\n    if (inputRef.current) inputRef.current.focus(opts);\n  }\n\n  function change(nextValue, originalEvent) {\n    handleChange(nextValue, {\n      lastValue: currentValue,\n      originalEvent\n    });\n  }\n  /**\n   * Rendering\n   */\n\n\n  (0, React.useImperativeHandle)(outerRef, () => ({\n    focus\n  }));\n  let shouldRenderPopup = (0, _WidgetHelpers.useFirstFocusedRender)(focused, currentOpen);\n  let valueItem = accessors.findOrSelf(data, currentValue);\n  let inputValue = accessors.text(suggestion || valueItem);\n  let completeType = filter ? 'list' : 'none';\n  let popupOpen = currentOpen && (!hideEmptyPopup || !!data.length);\n  return /*#__PURE__*/React.createElement(_Widget.default, Object.assign({}, elementProps, {\n    ref: ref,\n    open: currentOpen,\n    dropUp: dropUp,\n    focused: focused,\n    disabled: isDisabled,\n    readOnly: isReadOnly\n  }, focusEvents, {\n    onKeyDown: handleKeyDown,\n    className: (0, _classnames.default)(className, 'rw-combobox')\n  }), /*#__PURE__*/React.createElement(_WidgetPicker.default, {\n    className: containerClassName,\n    hideCaret: hideCaret\n  }, /*#__PURE__*/React.createElement(_Input.default, Object.assign({}, inputProps, {\n    role: \"combobox\",\n    name: name,\n    id: inputId,\n    className: (0, _classnames.default)( // @ts-ignore\n    inputProps && inputProps.className, 'rw-widget-input rw-combobox-input'),\n    autoFocus: autoFocus,\n    tabIndex: tabIndex,\n    disabled: isDisabled,\n    readOnly: isReadOnly,\n    \"aria-busy\": !!busy,\n    \"aria-owns\": listId,\n    \"aria-autocomplete\": completeType,\n    \"aria-expanded\": currentOpen,\n    \"aria-haspopup\": true,\n    placeholder: placeholder,\n    value: inputValue,\n    onChange: handleInputChange,\n    onKeyDown: handleInputKeyDown,\n    ref: inputRef\n  })), !hideCaret && /*#__PURE__*/React.createElement(_InputAddon.default, {\n    busy: busy,\n    icon: selectIcon,\n    spinner: busySpinner,\n    onClick: handleClick,\n    disabled: !!isDisabled || isReadOnly // FIXME\n    ,\n    label: messages.openCombobox()\n  })), /*#__PURE__*/React.createElement(_FocusListContext.FocusListContext.Provider, {\n    value: list.context\n  }, shouldRenderPopup && /*#__PURE__*/React.createElement(_Popup.default, {\n    dropUp: dropUp,\n    open: popupOpen,\n    transition: popupTransition,\n    onEntering: () => listRef.current.scrollIntoView()\n  }, /*#__PURE__*/React.createElement(ListComponent, Object.assign({}, listProps, {\n    id: listId,\n    tabIndex: -1,\n    data: data,\n    groupBy: groupBy,\n    disabled: disabled,\n    accessors: accessors,\n    renderItem: renderListItem,\n    renderGroup: renderListGroup,\n    optionComponent: optionComponent,\n    value: selectedItem,\n    searchTerm: valueItem && accessors.text(valueItem) || '',\n    \"aria-hidden\": !popupOpen,\n    \"aria-labelledby\": inputId,\n    \"aria-live\": popupOpen ? 'polite' : void 0,\n    onChange: (d, meta) => handleSelect(d, meta.originalEvent),\n    ref: listRef,\n    messages: {\n      emptyList: rawData.length ? messages.emptyFilter : messages.emptyList\n    }\n  })))));\n});\nComboboxImpl.displayName = 'Combobox';\nComboboxImpl.propTypes = propTypes;\nvar _default = ComboboxImpl;\nexports.default = _default;"]},"metadata":{},"sourceType":"script"}